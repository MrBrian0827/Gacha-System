<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>🎴 抽卡系統</title>
<link rel="stylesheet" href="style.css">
<style>
body{margin:0;padding:0;font-family:Arial,sans-serif;background:#f0f0f0;}
header{background:#4a90e2;color:#fff;padding:12px 20px;text-align:center;font-size:1.3em;}
.container{padding:20px;}
.buttons{display:flex;justify-content:center;gap:10px;flex-wrap:wrap;margin-bottom:20px;}
.buttons button{padding:10px 16px;font-size:1em;border:none;border-radius:8px;cursor:pointer;}
.buttons button.primary{background:#4a90e2;color:#fff;}
.buttons button.secondary{background:#fff;border:1px solid #ccc;}

#results{display:flex;flex-wrap:wrap;gap:12px;justify-content:center;}
.card{width:140px;height:220px;perspective:800px;cursor:pointer;}
.card-inner{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform 0.6s;}
.card.flipped .card-inner{transform:rotateY(180deg);}
.card-front,.card-back{position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:10px;display:flex;flex-direction:column;align-items:center;justify-content:space-between;padding:8px;box-shadow:0 4px 8px rgba(0,0,0,0.2);background:#fff;}
.card-back{background:#aaa;transform:rotateY(180deg);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:bold;}
.card-front .name{font-weight:bold;font-size:0.9em;align-self:flex-start;}
.card-front .rarity{position:absolute;top:4px;right:4px;font-size:0.8em;font-weight:bold;padding:2px 4px;border-radius:4px;color:#fff;}
.card-front .rarity.N{background:#999;}
.card-front .rarity.R{background:#4caf50;}
.card-front .rarity.SR{background:#ff9800;}
.card-front .rarity.SSR{background:#e91e63;}
.card-front .rarity.UR{background:#9c27b0;}
.card-front .image img{width:100%;height:auto;border-radius:6px;}
.card-front .effect{font-size:0.7em;text-align:center;margin:4px 0;}
.card-front .atk,.card-front .hp{font-size:0.7em;}
.card-front .atk{align-self:flex-start;}
.card-front .hp{align-self:flex-end;}
@media(max-width:600px){.card{width:100px;height:160px;}}
</style>
</head>
<body>
<header>🎴 抽卡系統</header>
<div class="container">
  <div class="buttons">
    <select id="poolSelect"><option value="">選擇卡池</option></select>
  </div>

  <div class="buttons">
    <button id="singleDraw" class="primary">🎲 單抽</button>
    <button id="tenDraw" class="primary">✨ 十連抽</button>
  </div>

  <div class="buttons secondary-buttons">
    <button class="secondary" onclick="location.href='probability.html'">📊 查看機率表</button>
    <button class="secondary" onclick="location.href='history.html'">📜 抽卡紀錄</button>
  </div>

  <div id="results"></div>
</div>

<script src="main.js"></script>
<script>
// 卡片渲染修改成翻牌
function showCard(card, delay=0){
  const resultsDiv = document.getElementById("results");
  const div = document.createElement("div");
  div.className = "card";

  const inner = document.createElement("div");
  inner.className = "card-inner";

  const front = document.createElement("div");
  front.className = "card-front";
  front.innerHTML = `
    <div class="name">${card.name}</div>
    <div class="rarity ${card.rarity}">${card.rarity}</div>
    <div class="image"><img src="${card.image||'https://via.placeholder.com/180x140.png?text=Card+Image'}" alt="${card.name}"></div>
    <div class="effect">${card.effect||"效果描述..."}</div>
    <div class="atk">ATK: ${card.attack||0}</div>
    <div class="hp">HP: ${card.hp||0}</div>
  `;

  const back = document.createElement("div");
  back.className = "card-back";
  back.textContent = "背面";

  inner.appendChild(front);
  inner.appendChild(back);
  div.appendChild(inner);

  // 點擊翻牌
  div.addEventListener("click",()=>div.classList.toggle("flipped"));

  setTimeout(()=>resultsDiv.appendChild(div), delay);

  // 記錄到 localStorage
  const history = JSON.parse(localStorage.getItem("drawHistory")||"[]");
  history.push(card);
  localStorage.setItem("drawHistory", JSON.stringify(history));
}
</script>
</body>
</html>
